

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Reaction-Diffusion 1D PDE &mdash; PDEControlGym 0.0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/css/pdecg_theme.css?v=c04f4f2d" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=d45e8c67"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Navier-Stokes 2D PDE" href="navierstokes2d.html" />
    <link rel="prev" title="Transport 1D PDE" href="hyperbolic-1d.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            PDEControlGym
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../guide/install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guide/quickstart.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guide/tutorials.html">Tutorials</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Environments</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="hyperbolic-1d.html">Transport 1D PDE</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Reaction-Diffusion 1D PDE</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#pde_control_gym.src.environments1d.ReactionDiffusionPDE1D"><code class="docutils literal notranslate"><span class="pre">ReactionDiffusionPDE1D</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pde_control_gym.src.environments1d.ReactionDiffusionPDE1D.reset"><code class="docutils literal notranslate"><span class="pre">ReactionDiffusionPDE1D.reset()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pde_control_gym.src.environments1d.ReactionDiffusionPDE1D.step"><code class="docutils literal notranslate"><span class="pre">ReactionDiffusionPDE1D.step()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#numerical-implementation">Numerical Implementation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="navierstokes2d.html">Navier-Stokes 2D PDE</a></li>
<li class="toctree-l1"><a class="reference internal" href="Trafficarz1d.html">Traffic ARZ 1D PDE</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Custom Environments</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../custom_environments/1dbaseenvironment.html">1D Custom Environments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../custom_environments/2dbaseenvironment.html">2D Custom Environments</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Utilities</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../utils/preimplementedrewards.html">Pre-implemented Rewards</a></li>
<li class="toctree-l1"><a class="reference internal" href="../utils/customrewards.html">Custom Rewards</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">PDEControlGym</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Reaction-Diffusion 1D PDE</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/environments/parabolic-1d.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="reaction-diffusion-1d-pde">
<span id="module-pde_control_gym.src.environments1d"></span><span id="parabolic"></span><h1>Reaction-Diffusion 1D PDE<a class="headerlink" href="#reaction-diffusion-1d-pde" title="Link to this heading"></a></h1>
<p>This documentation is for the 1D Reation-Diffusion PDE Environment defined by the boundary control problem</p>
<div class="math notranslate nohighlight">
    \begin{eqnarray}
    u_t(x, t) &amp;=&amp; u_{xx}(x, t) + \lambda(x) u(0, t), \quad x \in [0, X], t \in [0, T]\,,\\
            u(0, t) &amp;=&amp; 0 \,,
    \end{eqnarray}</div><p>where <span class="math notranslate nohighlight">\(\lambda(x)\)</span> is the nonlinear, spatial-varying recirculation plant coefficient and control can be applied as either second boundary condition following</p>
<div class="math notranslate nohighlight">
\begin{eqnarray}
    u(X, t) &amp;=&amp; U(t) \qquad \text{Dirchilet Boundary Conditions}\,,\\
    u_x(X, t) &amp;=&amp; U(t) \qquad \text{Neumann Boundary Conditions}\,.
\end{eqnarray}</div><p>This problem is the simplest possible Parabolic PDE benchmark and thus is a good indicator of potentially algorithmic success on more difficult problems. The goal of the problem is to stabilize the system (<span class="math notranslate nohighlight">\(\lim_{t \to \infty} \|u(x, t)\| = 0\)</span>) where the norm can be varied depending on the problem formulation and continuity of the plant coefficient <span class="math notranslate nohighlight">\(\lambda(x)\)</span>. A variety of sensing options are supported for the implementation as well if one wants to attempt to perform output feedback stabilization. See the parameter list below.</p>
<dl class="py class">
<dt class="sig sig-object py" id="pde_control_gym.src.environments1d.ReactionDiffusionPDE1D">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pde_control_gym.src.environments1d.</span></span><span class="sig-name descname"><span class="pre">ReactionDiffusionPDE1D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sensing_noise_func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset_init_condition_func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset_recirculation_func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sensing_loc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'full'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">control_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Dirchilet'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sensing_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Dirchilet'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limit_pde_state_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_state_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000000000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_control_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">control_sample_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pde_control_gym/src/environments1d/parabolic.html#ReactionDiffusionPDE1D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pde_control_gym.src.environments1d.ReactionDiffusionPDE1D" title="Link to this definition"></a></dt>
<dd><p>Reaction-Diffusion PDE 1D</p>
<p>This class implements the 1D Reaction-Diffusion PDE and inhertis from the class <code class="xref py py-class docutils literal notranslate"><span class="pre">PDEEnv1D</span></code>. Thus, for a full list of of arguments, first see the class <code class="xref py py-class docutils literal notranslate"><span class="pre">PDEEnv1D</span></code> in conjunction with the arguments presented here</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sensing_noise_func</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[[<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>]</span>) – Takes in a function that can add sensing noise into the system. Must return the same sensing vector as given as a parameter.</p></li>
<li><p><strong>reset_init_condition_func</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>]</span>) – Takes in a function used during the reset method for setting the initial PDE condition <span class="math notranslate nohighlight">\(u(x, 0)\)</span>.</p></li>
<li><p><strong>reset_recirculation_func</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>]</span>) – Takes in a function used during the reset method for setting the initial plant parameter <span class="math notranslate nohighlight">\(\beta\)</span> vector at the start of each epsiode.</p></li>
<li><p><strong>sensing_loc</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></span>) – Sets the sensing location as either <code class="docutils literal notranslate"><span class="pre">&quot;full&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;collocated&quot;</span></code>, or <code class="docutils literal notranslate"><span class="pre">&quot;opposite&quot;</span></code> which indicates whether the full state, the boundary at the same side of the control, or boundary at the opposite side of control is given as the observation at each time step.</p></li>
<li><p><strong>control_type</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></span>) – The control location can either be given as a <code class="docutils literal notranslate"><span class="pre">&quot;Dirchilet&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;Neumann&quot;</span></code> boundary conditions and is always at the <code class="docutils literal notranslate"><span class="pre">X</span></code> point.</p></li>
<li><p><strong>sensing_type</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></span>) – Only used when <code class="docutils literal notranslate"><span class="pre">sensing_loc</span></code> is set to <code class="docutils literal notranslate"><span class="pre">opposite</span></code>. In this case, the sensing can be either given as <code class="docutils literal notranslate"><span class="pre">&quot;Dirchilet&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;Neumann&quot;</span></code> and is given at the <code class="docutils literal notranslate"><span class="pre">0</span></code> point.</p></li>
<li><p><strong>limit_pde_state_size</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></span>) – This is a boolean which will terminate the episode early if <span class="math notranslate nohighlight">\(\|u(x, t)\|_{L_2} \geq\)</span> <code class="docutils literal notranslate"><span class="pre">max_state_value</span></code>.</p></li>
<li><p><strong>max_state_value</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></span>) – Only used when <code class="docutils literal notranslate"><span class="pre">limit_pde_state_size</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>. Then, this sets the value for which the <span class="math notranslate nohighlight">\(L_2\)</span> norm of the PDE will be compared to at each step asin <code class="docutils literal notranslate"><span class="pre">limit_pde_state_size</span></code>.</p></li>
<li><p><strong>max_control_value</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></span>) – Sets the maximum control value input as between [<code class="docutils literal notranslate"><span class="pre">-max_control_value</span></code>, <code class="docutils literal notranslate"><span class="pre">max_control_value</span></code>] and is used in the normalization of action inputs.</p></li>
<li><p><strong>control_sample_rate</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></span>) – Sets the sample rate at which the controller is applied to the PDE. This allows the PDE to be simulated at a smaller resolution then the controller.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pde_control_gym.src.environments1d.ReactionDiffusionPDE1D.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pde_control_gym/src/environments1d/parabolic.html#ReactionDiffusionPDE1D.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pde_control_gym.src.environments1d.ReactionDiffusionPDE1D.reset" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>seed</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]</span>) – Allows a seed for initialization of the envioronment to be set for RL algorithms.</p></li>
<li><p><strong>options</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>]</span>) – Allows a set of options for the initialization of the environment to be set for RL algorithms.</p></li>
</ul>
</dd>
</dl>
<p>Resets the PDE at the start of each environment according to the parameters given during the PDE environment intialization</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pde_control_gym.src.environments1d.ReactionDiffusionPDE1D.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">control</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pde_control_gym/src/environments1d/parabolic.html#ReactionDiffusionPDE1D.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pde_control_gym.src.environments1d.ReactionDiffusionPDE1D.step" title="Link to this definition"></a></dt>
<dd><p>Moves the PDE with control action forward <code class="docutils literal notranslate"><span class="pre">control_sample_rate*dt</span></code> steps.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>control</strong> – The control input to apply to the PDE at the boundary.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<section id="numerical-implementation">
<h2>Numerical Implementation<a class="headerlink" href="#numerical-implementation" title="Link to this heading"></a></h2>
<p>We derive the numerical implementation scheme for those looking for inner details of the environment. We use a first-order finite-difference scheme to approximate the PDE leading to super fast implementation speeds - although with sacrifice on spatial and temporal timestep parameterization.</p>
<p>Consider the first-order taylor approximation as</p>
<div class="math notranslate nohighlight">
\begin{eqnarray}
    u(x, t+1) = u(x, t) + \Delta t u_t(x, t)\,,
\end{eqnarray}</div><p>with finite spatial derviatves approximated by first-order centered diffrences</p>
<div class="math notranslate nohighlight">
\begin{eqnarray}
    \frac{\partial^2 u}{\partial x^2} = \frac{u_{j+1}^n - 2u_j^n+u_{j-1}^n}{(\Delta x)^2}\,,
\end{eqnarray}</div><p>where <span class="math notranslate nohighlight">\(\Delta t=dt=\text{time step}\)</span>, <span class="math notranslate nohighlight">\(\Delta x=dx=\text{spatial step}\)</span>, <span class="math notranslate nohighlight">\(n=0, ..., Nt\)</span>, <span class="math notranslate nohighlight">\(j=0, ..., Nx\)</span>, where <span class="math notranslate nohighlight">\(Nt\)</span> and <span class="math notranslate nohighlight">\(Nx\)</span> are the total number of discretized temporal and spatial steps respectively. Then substituting <span class="math notranslate nohighlight">\(u_{xx}\)</span> and <span class="math notranslate nohighlight">\(u_t\)</span> into the taylor approximation yields</p>
<div class="math notranslate nohighlight">
\begin{eqnarray}
    u_j^{n+1} = u_j^n +  \Delta t \left(\frac{u_{j-1}^n - 2 u_j^n + u_{j+1}^n}{(\Delta x)^2} + \lambda_j u_j^n \right) \,.
\end{eqnarray}</div><p>Now, the last thing to consider the is boundary conditions. Begin with the harder Neumann boundary condition. Let <span class="math notranslate nohighlight">\(u_\zeta^n|_{\zeta=Nx}\)</span> represent the spatial derivative at time <span class="math notranslate nohighlight">\(t\)</span> of spatial  point <span class="math notranslate nohighlight">\(Nx=X\)</span> which is given by the user as control input. Then, we have</p>
<div class="math notranslate nohighlight">
 \begin{eqnarray}
     u_\zeta^n|_{\zeta=Nx} = \frac{u_{Nx}^{n} - u_{Nx-1}^n}{\Delta x}\,,
 \end{eqnarray}</div><p>which is rearranged for the final boundary point</p>
<div class="math notranslate nohighlight">
 \begin{eqnarray}
     u_{Nx}^n = u_{Nx-1}^n + (\Delta x) u_\zeta^n|_{\zeta=Nx}\,.
 \end{eqnarray}</div><p>In the case of Dirchilet boundary conditions, the computation is straightforward as <span class="math notranslate nohighlight">\(u_{Nx}^n\)</span> is directly set as the given control input.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="hyperbolic-1d.html" class="btn btn-neutral float-left" title="Transport 1D PDE" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="navierstokes2d.html" class="btn btn-neutral float-right" title="Navier-Stokes 2D PDE" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, PDEContRoLGym.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>